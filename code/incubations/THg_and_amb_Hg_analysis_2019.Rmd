---
title: "Total Hg and ambient Hg/MeHg from 2019 incubations"
author: "Benjamin D. Peterson"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(ggplot2)
library(patchwork)
library(tidyverse)

cb.translator <- readRDS("/Users/benjaminpeterson/Box/ancillary_science_stuff/colors/colorblind_friendly_colors_R/colorblind_friendly_colors.rds")

empty.plot <- function(x) {
  plot(x = 0,
       cex = 0,
       xaxt = "n",
       yaxt = "n",
       xlab = "",
       bty = "n")
}

```

### Investigation of THg data from incubations

First, we'll look at the raw THg values at t0 and t1.
Here's ^198^Hg.

```{r raw T198Hg values, out.width="75%", out.height = "75%", echo=FALSE}
library(knitr)
# Read in a PDF of the document
graph.path <- "/Users/benjaminpeterson/Documents/research/BLiMMP/results/incubations/THg_198_BLiMMP_incubations.png"
include_graphics(graph.path)
```

And here's ^204^Hg.

```{r raw T204Hg values, out.width="75%", out.height = "75%", echo=FALSE}

graph.path <- "/Users/benjaminpeterson/Documents/research/BLiMMP/results/incubations/THg_204_BLiMMP_incubations.png"
include_graphics(graph.path)


```


With both isotopes, we see a relatively consistent decrease in THg levels.
There are two potential explanations for this:

1. We're losing Hg to the sides of the bags during the incubations.
This would be a problem in that our rates could be affected by the amount of adsorption of Hg to the container walls.

2. I didn't do a good job of sampling.
After we spike the bags, I used some sample water to purge the tubing, then "massaged" the bag to mix the sample in.
However, it's possible that I didn't do a good enough job of mixing, and that the initial higher levels of Hg are due to me not adequately mixing the samples.

If #1 is the case, I would expect that 204 and 198 are not affected equally, since it is unlikely that MeHg and THg are absorbing to the walls at the same rate (I think?).
However, if #2 is the case, I would expect that 204 and 198 would track perfectly, since they were both injected as part of the same solution and, hypothetically, should be mixed equally well (or equally poorly).

#### Ratio of 198 to 204

So, I wanted to look at the ratios of ^204^Hg to ^198^Hg, first just at the raw numbers, then the shift between the two time points.
We'll look at the ratios for each date and depth separately, just to cut down on the noise.
The solid line is a 1:1 line.

```{r 198vs204 2019-08-30, fig.width = 15, fig.height = 5, echo=FALSE}

color.vector <- c(cb.translator["vermillion"],
                  cb.translator["bluishgreen"],
                  cb.translator["black"],
                  cb.translator["orange"],
                  cb.translator["blue"],
                  cb.translator["reddishpurple"])
names(color.vector) <- c("filtered-unamended",
                         "unfiltered-unamended",
                         "unfiltered-molybdate",
                         "unfiltered-starch",
                         "unfiltered-starch-molybdate",
                         "unfiltered-algal")

shape_vector <- c(17, 19)
names(shape_vector) <- c("t0", "t1")

THg.data.all <- read.csv("/Users/benjaminpeterson/Documents/research/BLiMMP/dataEdited/incubations/THg/incubations2019_THg.csv",
                     stringsAsFactors = FALSE)
for (date.of.interest in unique(THg.data.all$startDate) %>% sort()) {
  
  THg.data <- THg.data.all %>%
    filter(startDate == date.of.interest)
  
  par(mfrow = c(1, 3),
      mar = c(4, 4, 3, 1),
      mgp=c(2,0.5,0),
      tck=-0.008)
  
  for (depth.of.interest in unique(THg.data$depth) %>% sort()) {
    THg.data.depth <- THg.data %>%
      filter(depth == depth.of.interest)
    
  plot(THg.data.depth$THg_198,
       THg.data.depth$THg_204,
       xlim = c(0, 2),
       ylim = c(0, 2),
       xlab = "T198Hg",
       ylab = "T204Hg",
       xaxs = "i",
       yaxs = "i",
       pch = shape_vector[THg.data.depth$t],
       cex = 1.5,
       cex.lab = 1.8,
       cex.axis = 1.5,
       cex.main = 2,
       col = color.vector[THg.data.depth$treatment],
       main = paste(date.of.interest, ": ",
                    depth.of.interest, "m", sep = ""))
  # text(THg.data.depth$THg_198,
  #      THg.data.depth$THg_204,
  #      labels = THg.data.depth$incubationID)
  abline(0, 1)

  }
  if (date.of.interest == "2019-10-08") {
    empty.plot()
    legend("topright",
           legend =  names(color.vector),
           text.col = color.vector,
           pch = NA,
           cex = 2)
    legend("bottomright",
           legend = names(shape_vector),
           pch = shape_vector,
           cex = 2.5)

  }
}

```


As expected, the ratios fall pretty tightly onto a 1:1 line.
This is encouraging, since the two isotopes were injected at a 1:1 ratio.
If we were to see substantial loss of Hg to the sides of the bag, I would think that the ability of the MeHg to absorb to the side of the bag would be substantially different than that of Hg, and we would see some systematic deviation from the 1:1 line.
Since we don't see that, I'm encouraged that we're not systematically losing a substantial portion of Hg to the sides of the bag.

However, there are some exceptions here.
The four most apparent as being divergent are from the same date, depth, and time point, 2019-08-30, 11.7m, and t=1.
All the other samples from that depth fall right on the 1:1 line, so it wasn't something systemic.
I checked the notes for these four incubations.
One of the molybdate-amended bags had some brown clumps in the bag, likely due to dying cells, but another bag had this too that wasn't off the 1:1 line.
They also weren't killed at a particularly different time.
Honestly, I have no idea what happened to these four.
There's not much more we can say about them, since we didn't see any methylation at this depth anyways, and there was no sulfide to start with, so can't go off of the redox state.

Some samples have a systematic deviation from the 1:1 line (see 2019-08-30, 20.1m).
In these samples, I would expect that we're seeing some sort of loss pathway, since all the pre-incubations were spiked with the same stock (which should be 1:1).
The line is deviating below the line, suggesting that it's a lost of ^204^Hg.
However, both the t1 and t0 samples fall on a similar line, suggesting that the loss pathway happened before they were even injected into the bags.

Still, need to expain the systematic deviation from t0 to t1 in total Hg.
I think it's likely due to poor mixing of the tracer injection into bag before sampling t0.
The spread looks better from the October trip than the August one, and we were more thorough in October about purging the spike out of the rubber tubing and mixing the tracer into the sample.



#### Ratio of loss of 198 to loss of 204

Let's do one more check on this, and look at the ratio of change between t0 and t1 across the incubations.

```{r loss of 198vs204 2019-08-30, fig.width = 15, fig.height = 5, echo=FALSE}

color.vector <- c(cb.translator["vermillion"],
                  cb.translator["bluishgreen"],
                  cb.translator["black"],
                  cb.translator["orange"],
                  cb.translator["blue"],
                  cb.translator["reddishpurple"])
names(color.vector) <- c("filtered-unamended",
                         "unfiltered-unamended",
                         "unfiltered-molybdate",
                         "unfiltered-starch",
                         "unfiltered-starch-molybdate",
                         "unfiltered-algal")

shape_vector <- c(17, 19)
names(shape_vector) <- c("t0", "t1")

T198Hg.data <- read.csv("/Users/benjaminpeterson/Documents/research/BLiMMP/dataEdited/incubations/THg/incubations2019_198Hg_delta.csv",
                     stringsAsFactors = FALSE) %>%
  select(-c(t0, t1))
T204Hg.data <- read.csv("/Users/benjaminpeterson/Documents/research/BLiMMP/dataEdited/incubations/THg/incubations2019_204Hg_delta.csv",
                     stringsAsFactors = FALSE) %>%
  select(-c(t0, t1))

THg.data.all <- full_join(T198Hg.data,
                          T204Hg.data)


for (date.of.interest in unique(THg.data.all$startDate) %>% sort()) {
  
  THg.data <- THg.data.all %>%
    filter(startDate == date.of.interest)
  
  par(mfrow = c(1, 3),
      mar = c(4, 4, 3, 1),
      mgp=c(2,0.5,0),
      tck=-0.008)
  
  for (depth.of.interest in unique(THg.data$depth) %>% sort()) {
    THg.data.depth <- THg.data %>%
      filter(depth == depth.of.interest)
    
  plot(THg.data.depth$per_change_198,
       THg.data.depth$per_change_204,
       xlim = c(-80, 30),
       ylim = c(-80, 30),
       xlab = "Discrepency between t1 and t0 of T198Hg (%)",
       ylab = "Discrepency between t1 and t0 of T204Hg (%)",
       xaxs = "i",
       yaxs = "i",
       pch = 18,
       cex = 2.5,
       cex.lab = 1.8,
       cex.axis = 1.5,
       cex.main = 2,
       col = color.vector[THg.data.depth$treatment],
       main = paste(date.of.interest, ": ",
                    depth.of.interest, "m", sep = ""))

  abline(0, 1)

  }
  if (date.of.interest == "2019-10-08") {
    empty.plot()
    legend("topright",
           legend =  names(color.vector),
           text.col = color.vector,
           pch = NA,
           cex = 2)
  }
}

```

For many of the samples, we see the samples toeing the 1:1 line.
This tells the same story: consistent differences between t0 and t1 in both 204 and 198 isotopes, suggesting that the discrepancy is due to sampling efforts rather than loss to container walls.
This is particularly evident in both depths from July, 20.1m on the August sampling date, and 19.3m in October.
At 14m in August and 16.18m in October, there is a noticable dip below the 1:1 line, which suggests that there is greater loss of T^204^Hg than T^198^Hg. 
This is curious, since I would have imagined that the inorganic Hg was "stickier" than MeHg, and since the ^204^Hg was all MeHg, that we would have seen selective loss of ^198^Hg.
Not sure what could cause this selective loss of MeHg.
At 11.7m in August, 5 of the incubations toe the line.
The other 4, however, exihibit substantial deviation above the line, suggesting there was a selective loss of ^198^Hg.
I'm not sure why it would have only happened in this subset of incubations only.
There was no sulfide in the water at this depth, and sulfide was the only redox measurement we collected from these bags, so we have no way of knowing if the redox condition was compromised.



### Takeaways

1. Take more time to ensure complete mixing of sample after injection of tracer.
2. There may be some unexplained loss pathways of both ^198^Hg and Me^204^Hg.
3. However, overall, there doesn't seem to be specific loss of ^198^Hg, which is the one I'm most concerned about.









## Ambient Hg and MeHg analysis

Jake had the good suggestion to look at ambient Hg levels in the bags to see how that compares to our loss of the tracers.
Note, this metric of looking at ambient Hg levels isn't perfect, because we incubated the sample in the bags for 24 hours before starting the tracer experiment, so we could have had Hg loss to the walls before t0.
I did collect an ambient Hg sample from most of these dates/depths before incubations, but we have not analyzed them yet, so I don't know what they are.
With that said, this should still be informative.

## Ambient THg

First I looked at the ambient THg levels.
To simplify it a bit, we'll just look at the ambient conditions first (unfiltered and filtered, no metabolic amendments).

```{r THg levels incubations unamended, message=FALSE, echo=FALSE}

knitr::include_graphics("/Users/benjaminpeterson/Documents/research/BLiMMP/results/incubations/ambient_Hg/ambient_THg_incubations_unamended.png")

```

Alright, this is a bit disconcerting.
Let's start at the beginning.
For the July trip, it actually looks pretty good, there isn't that much of a substantial shift between THg levels at t0 and t1.
The August trip is a whole different story though.
Most of the t0 samples look pretty good.
They're around 1ng/L at 11.7m and 14m, which is maybe a little high for what we would expect at 11.7m, but pretty reasonable, and 1.5-2.0 ng/L at 20.1m.
However, at t1, most of these skyrocket, increasing by as much as 2ng/L. It's not consistent though, some incubations see only a small increase (0.2ng/L).
In October, the results calm down a little bit.
There's one high t0 sample at the lowest depth.

I then looked at the amended incubations.

```{r THg levels incubations amended, message=FALSE, echo=FALSE}

knitr::include_graphics("/Users/benjaminpeterson/Documents/research/BLiMMP/results/incubations/ambient_Hg/ambient_THg_incubations_amended.png")

```

Same story in August, some really high values at t1, but a few that are more normal.
In October, there's more evidence for contamination during the t0 sampling event, with a few samples hovering around the 3-4ng/l range, which is much too high.
The t1 samples don't look to be affected though.
So what gives?

The high samples were all analyzed on different days, which makes me think that it isn't due to analysis error or contamination during analysis prep, but contamination during the sampling.
I feel like I used a mix of syringes during t1 sampling in August, and some of those were used in t0 sampling in October, where we also see several samples waaaayyyy too high in THg.
Could be other causes too... maybe contaminated PETG bottles?
Either way, should be sure to be extra careful about where I'm getting my sampling supplies this year, test them out, and make sure I keep it consistent across all incubations.
Of the samples without outrageous t0 or t1 samples, it doesn't look like we're having systematic Hg loss, but it's impossible to tell with all the contamination.




#### Ambient MeHg levels

Let's look at MeHg.
Note, the loss of ambient MeHg could be due to either demethylation in the bags or evasion to the walls.
With the THg contamination, we can't really determine which one is the case.
Again, we'll look at just the filtered controls and ambient conditions first.

```{r MeHg levels incubations unamended, message=FALSE, echo=FALSE}

knitr::include_graphics("/Users/benjaminpeterson/Documents/research/BLiMMP/results/incubations/ambient_Hg/ambient_MeHg_incubations_unamended.png")

```

Again, looks pretty good for the July trip!
Essentially no MeHg at the uppermost depth, so no chance for a decrease.
At 20m, we see a minor decrease on average, but not much.

In August, we have a little more of mixed bag.
Several bottles, both in t1 and t0, have large abnormalities compared to the other bottles.
However, many of these are higher than we would expect, rather than lower.
Other than that, we do tend to see a minor drop in MeHg over the incubation, but usually only around 0.1ng/L.
Would be nice to know what the MeHg concentrations were in the water column, so we'll have to analyze those samples when we get back to it.

In October, the decreases in MeHg are a little more steep.
Here, we're definitely seeing evidence for MeHg loss.
The spread on the data here is also much more substantial than it is on the other two dates.

And in the amended samples:

```{r MeHg levels incubations amended, message=FALSE, echo=FALSE}

knitr::include_graphics("/Users/benjaminpeterson/Documents/research/BLiMMP/results/incubations/ambient_Hg/ambient_MeHg_incubations_amended.png")

```

Not too different, pretty much the same story as with the unamended samples, in that the loss of MeHg is most pronounced in the October incubations.

#### Takeways:

1. We can't tell if there is loss of ambient Hg to the bag walls during the first 24 hours in the bag, since we haven't get analyzed the water column samples we collected yet.
2. Contamination in the THg samples limits our interpretation of these results. While there seems to be no loss of THg in the apparently uncontaminated bags, it's hard to say so with any confidence due to the known contamination issue.
3. There does seem to be consistent loss of MeHg through the incubations, but it's relatively minor. Could either be due to loss to walls or demethylation. This loss becomes more prominent in October.
